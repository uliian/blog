---
title: OpenWRT软路由使用中遇到的几个问题
date: 2022-04-10 17:38:51
tags:
    - OpenWRT
    - X18G
---

记录一下家中使用OpenWRT遇到的问题
<!-- more -->

家里网络一直不是很稳定，初步判断还是由于核心路由器有问题造成的，一开始使用的核心路由器`网件 R7000`，但是近几个版本的固件感觉总是有问题，很容易断流，尤其是无线网络，断流得丧心病狂。我多次遇到王者荣耀延迟460的情况，让人十分抓狂。一年多前，为了家里宽带覆盖，也买了一台`水星X18G`作为辅助路由，一气之下把X18G作为了主路由。我对路由器的使用应该算是中度使用，主要还是用到了一些端口映射，一般有个5、6条端口映射规则。DDNS我是用的我的NAS做的，X18G作为主路由以后，无线稳定性是提升了一些，但是整体表现还是让我很不满意，想升级路由器来着，后来一番对比以后，觉得还是软路由最香，于是上了一台J4125，8G内存软路由。

在折腾过程中还是遇到了一些小问题，在这里记录一下：

1、X18G无法选择桥接模式；

2、腾讯云，DDNS的设置问题。


# X18G无法选择桥接模式

&emsp;&emsp;说起这个问题，我严重怀疑水星为这款路由器砸了不少推广费，各位可以到知乎进行搜索，大量答主推荐这款路由器，我也就是在看了这些推荐后，买下了这款路由器。但是在后期深入使用后，尤其是作为主路由使用后，发现这款路由器真就是一款很入门的路由器，虽然它有wifi6，但是我使用到的内网映射、桥接模式两项功能，体现出极其不专业的特性来。

1）端口转发没有规则备注

这是一个小问题，但是却严重影响操作体验，我的内网有NAS一台，做了虚拟化；工作站一台，同样做了虚拟化。大量端口映射简直是刚需，10多个端口映射往那一放，我滴个乖乖，咋知道谁是谁？这一点R7000就作得很专业。

2）无法选择桥接模式

我上了路由器以后，内部网络肯定是互通的，而且我的局域网并没有十分大，也就小几十个终端，我没必要做一些复杂的网络划分，我希望所有设备都在同一局域网内，使用的IP都是通过核心路由进行分配管理的。而我在X18G里，翻了个遍，没找到哪里可以切换到桥接模式。后来，我准备放弃治疗之时，顺手关闭DHCP服务器，结果，突然找到了答案：**关闭DHCP将自动切换到桥接模式！！** 我真想问候水星这款路由器PM的全家！同时，也真真反映出这款路由器设计的不专业性。如果各位对路由器有稍稍专业的应用场景需求，强烈强烈强烈不推荐这款路由器。

# 腾讯云OpenWRT DDNS设置问题

&emsp;&emsp;这口锅是腾讯云的，问题的根子在于腾讯云提供的DNS服务基本来自原DNSPod的产品。甚至出现了鬼魅的DNSPod Token，腾讯云Token两套Token。如果你初次使用腾讯云相关DDNS配置，大概率会被这俩货搞晕。OpenWRT（高大全版）本身自带了DDNS支持，同时腾讯云也提供了OpenWRT的相关DDNS插件`luci-app-tencentddns`。一开始，我在OpenWRT中的DDNS相关配置中并没有找到腾讯云的相关配置，于是使用了腾讯提供的OpenWRT组件来自动更新DDNS。可是多次配置，都无法正常使用这货，关键在于，这货的错误提示太过含蓄，完全找不到有用信息，只会提示`ERROR, Please Check Config/Time`。GitHub上有人提了这个问题，腾讯相关方面选择了以躺平作为回应。终于，我在一脸懵逼中，放弃了这一插件（而且这一插件占用一级菜单，对强迫症极不友好）。

&emsp;&emsp;在找寻`luci-app-tencentddns`相关答案的时候，我猛然看见有同学反映，配置的token要使用[**DNSPod的Token**](https://github.com/Tencent-Cloud-Plugins/tencentcloud-openwrt-plugin-ddns/issues/12)，突然灵光乍现，到OpenWRT中自带的DDNS模块中查找是否有DNSPod的支持，居然真的存在DNSPod的支持！！但是，填写的时候还是遇到不少坑，我附上了这一截图

![DnsPodConfig](https://blog.uliian.com/img/DnsPodConfig.png "DnsPodConfig")

总是感觉这货的配置是为了迎合OpenWRT的通用摸板来做的，很难理解，也没有相关注释，再加上腾讯云作怪，很容易让人难理理解，不过照着我的注释来做，你也应该很快就能配置完成！

最后说一句，软路由，真香我把原来交给NAS宿主机做的FRP映射、DDNS更新统统搬迁到了OpenWRT里面，感觉真是很开心~爱折腾的你，值得拥有！